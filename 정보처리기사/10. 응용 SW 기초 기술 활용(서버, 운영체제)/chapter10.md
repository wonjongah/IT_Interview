##### 레지스터

<u>처리 중인 데이터나 처리 결과를 임시 보관하는 기능</u>을 하며 <u>산술 연산이나 정보 해석, 전송등을 할 수 있는 일정 길이의 정보를 저장하는 CPU 내부의 초고속 기억장치</u>



##### 레지스터의 종류

| 종류                         | 상세설명                                                     |
| ---------------------------- | ------------------------------------------------------------ |
| PC(PROGRAM COUNTER)          | 다음에 인출할 명령어의 주소를 가지고 있는 레지스터           |
| MAR(MEMORY ADDRESS REGISTER) | 메모리 주소를 일시적으로 저장하는 레지스터                   |
| MBR(MEMORY BUFFER REGISTER)  | 기억장치에 쓰여질 데이터 혹은 기억장치로부터 읽혀진 데이터를 일시적으로 저장하는 버퍼 레지스터 |
| IR(INSTRUCTION REGISTER)     | 가장 최근에 인출된 명령어 코드가 저장되어 있는 레지스터      |
| AC(ACCUMULATOR)              | 데이터나 연산결과를 일시적으로 저장하는 레지스터             |



##### 레지스터 동작 절차

- 명령어 인출과정에서 MAR이 지시하는 주기억장치의 주소 번지에서 데이터를 읽어와서 MBR에 저장한다.
- 저장 과정에서는 MAR에 저장되어 있는 주소 번지에 해당하는 주기억장치 위치에 MBR에 저장되어 있는 데이터를 저장한다.



##### 인터럽트

프로그램 실행 중 CPU의 현재 처리 순서를 중단시키고 다른 동작을 수행하도록 요구하는 시스템 동작



##### 인터럽트 발생원인

- 기계적인 문제(정전, 데이터 전달 과정에서 하드웨어 오류 발생)
- 프로그램 상의 문제
- 컴퓨터 조작자의 의도적인 조작에 의한 중단
- 입출력 장치들의 동작에 CPU의 기능이 요청되는 경우
- 산술 연산 오버 플로우, 언어플로우 발생



##### 인터럽트 유형

- 외부 인터럽트(하드웨어 인터럽트)
  - 전원 이상 
    - 정전 또는 전원 이상에 의한 인터럽트 발생
  - 기계 착오
    - CPU의 기능적인 오류 동작 발생
  - 외부 신호
    - 타이머에 의한 규정된 시간을 알리는 경우
    - 키보드로 인터럽트 발생
    - 외부 장치로부터 인터럽트 요청 발생
  - 입/출력
    - 입출력 데이터의 오류나 이상 현상이 발생한 경우
    - 입출력 장치가 데이터의 전송을 요구 또는 전송 완료 알림
- 내부 인터럽트(하드웨어 인터럽트)
  - 프로그램 검사
    - 0으로 나누기
    - 오버 플로우, 언어플로우
    - 부당한 기억장소 참조와 같은 프로그램 상 오류
- 소프트웨어 인터럽트
  - SVC 명령
    - 사용자가 SVC 명령을 써서 의도적으로 발생한다.
    - 기억장치 할당 및 오퍼레이터와의 통신이 필요한 경우



##### 인터럽트 처리 루틴

- 인터럽트가 발생하면, 인터럽트를 받은 장치는 현재 자신의 상태를 PCB라는 자료구조에 기억시켜두고 인터럽트를 처리한다.
- 인터럽트 처리루틴(IPR)을 수행한 후, 인터럽트 처리 시 보존시켰던 상태를 제어상태 레지스터에 복구한다.

인터럽트 인지 -> 현재 상태 보존 -> 요청 인터럽트 서비스로 분기 및 서비스 -> 사용자 상태 복구 및 재개



##### 명령어 수행 과정(INSTRUCTION CYCLE)

- 명령어 사이클은 인출 - 해독 - 실행 - 저장의 순서이다.
- Fetch한 명령어의 operand가 간접주소일 경우 : Indirect Cycle
- Fetch한 명령어의 operand가 직접주소인 경우 : Execute Cycle

<u>명령어 인출 -> 명령어 해독 -> 명령어 실행 -> 데이터 저장</u>



##### 프로세스의 주 상태 종류

- 인출(Fetch Cycle)
  - 주기억장치로부터 수행할 명령어를 cpu로 가져오는 단계
  - 명령어의 operand가 간접주소일 경우 : Indirect Cycle
  - 명령어의 operand가 직접주소인 경우 : Execute Cycle
- 간접(indirect Cycle)
  - 명령어의 operand가 간접주소 지정이 된 경우 유효 주소를 계산하기 위해 주기억장치에 접근하는 단계
- 실행(Execute Cycle)
  - 명령의 코드를 해독결과에 따라 필요한 연산들을 수행
- 인터럽트(Interrupt Cycle)
  - 인터럽트 발생 시 인터럽트 처리를 하고 완료되면 Fetch로 진행



##### Locality(구역성, 지역성, 국부성, 국소성)

- 프로그램의 어느 한 특정 부분만 한동안 집중적으로 참조하는 현상
- 메모리 계층구조나 데이터베이스의 LRU 알고리즘은 구역성 특징을 활용해 성능을 향상시킨 사례이다.

| 기법        | 내용                                                         | 사례                        |
| ----------- | ------------------------------------------------------------ | --------------------------- |
| 시간 구역성 | 최근에 액세스된 프로그램이나 데이터가 가까운 미래에 다시 액세스 될 가능성이 높다. | loop, subroutine            |
| 공간 구역성 | 기억장치 내 인접하여 저장된 데이터들이 연속적으로 액세스 될 가능성이 높다 | array, table, 순차코드 실행 |
| 순차 구역성 | 분기하지 않는 한, 명령어들은 기억장치에 저장된 순서대로 인출되어 실행된다. | 구조적 프로그래밍           |



##### 인터럽트 우선순위

- 소프트웨어 방식(**폴링**)
  - CPU가 모든 I/O 제어기들에 접속된 선 이용, 인터럽트를 요구한 장치를 검사하는 방식
  - Test I/O 신호를 이용해 각 I/O 장치의 인터럽트 플래그 세트되어 있는지 검사
  - 검사 순서가 우선 순위를 결정
  - 장점
    - 소프트웨어 수정을 통해 우선순위 변경이 쉽다.
    - 회로가 간단하고 융통성이 있으며 별도의 하드웨어 불필요
  - 단점
    - 많은 인터럽트가 있을 경우 그것들을 모두 조사하는데 많은 시간이 걸려 처리시간이 오래 걸린다.
- 하드웨어 방식
  - **직렬연결**
    - **Daisy-Chain(데이지 체인)**
    - 우선순위 부여 방식으로 인터럽트가 발생하는 모든 장치를 한 개의 회선에 직렬로 연결(CPU로 발생되는 INTA 출력선을 I/O 제어기들에 직렬로 접속하는 방식)
    - 우선순위가 높은 장치를 선두에 위치시키고 나머지를 우선순위에 따라 차례로 연결한다.
    - 인터럽트를 요구한 I/O 장치는 Ain 입력을 받는 즉시 자신의 고유번호, 인터럽트 벡터를 벡터 버스를 통해 CPU로 전송한다.
    - 인터럽트 벡터는 해당 I/O 장치를 위한 인터럽트 서비스 루틴의 시작 주소를 결정한다.
  - 장점
    - 하드웨어 구조가 간단하다.
  - 단점
    - 우선순위 낮은 장치들이 서비스를 받지 못하는 현상이 발생한다.
  - **병렬연결**
    - **Mutiple Interrupt**
    - 각 I/O 제어기와 CPU 사이에 인터럽트 요구선과 인터럽트 확인 선을 접속하는 방식
    - 인터럽트가 발생하는 각 장치를 개별적인 회선으로 연결한다.
    - 각 장치의 회선에 대응하는 Mask Register를 사용하고 우선순위는 Mask Register의 비트 위치에 의해 결정한다.
  - 장점
    - cpu가 인터럽트를 요구한 장치식별이 용이하다.
  - 단점
    - 입력 핀의 수에 의해 제한한다.