##### 데이터베이스 이상현상 (Anomaly)

- 이상현상은 정규화를 거치지 않으면 데이터베이스의 데이터들이 불필요하게 중복되어 릴레이션 조작 시 문제가 발생하는데, 이를 이상현상이라고 한다.
- 이상현상의 종류

| 종류            | 설명                                                         |
| --------------- | ------------------------------------------------------------ |
| 삽입 이상       | 테이블에 데이터를 삽입할 때, 의도와는 관계없이 원하지 않는 값들로 인해 삽입할 수 없는 현상 |
| 수정(갱신) 이상 | 테이블에서 튜플에 있는 속성값을 갱신할 때 일부 튜플의 정보만 갱신되어 정보에 불일치성이 생기는 현상 |
| 삭제 이상       | 테이블에서 한 튜플을 삭제할 때, 의도와는 관계 없이 값들도 함께 삭제되면서 연쇄삭제가 일어나는 현상 |



##### 정규화 (Normalization)

- 정규화는 관계형 데이터베이스 설계 시 중복을 최소화하도록 데이터를 구조화하는 프로세스로서 제대로 조직되지 않은 테이블들과 관계들을 작고 잘 조직된 테이블과 관계들로 나누는 무손실 분해를 포함한다.
- 정규화를 수행하는 목적은 다음과 같다.
  - 하나의 테이블에서 데이터의 삽입, 삭제, 변경이 정의된 관계들로 인하여 데이터베이스의 나머지 부분들로 전파되게 하는 것
  - 어떤 관계라도 데이터베이스 내에서 표현이 가능하도록 만드는 것
  - 새로운 형태의 데이터가 삽입될 때 관계를 재구성할 필요성을 줄인다.
  - 보다 간단한 관계 연산에 기초하여 검색을 보다 효율적으로 한다.
- 정규화의 원칙은 낮은 차수의 정규화를 만족한 상태로 높은 차수의 정규화를 진행한다.

| 원칙               | 설명                                                         |
| ------------------ | ------------------------------------------------------------ |
| 무손실 표현        | 같은 의미의 정보 유지하면서 더 바람직한 구조를 만듦          |
| 자료의 중복성 감소 | 중복되는 정보는 삭제하거나 통합                              |
| 분리의 원칙        | 독립적인 관계는 별개의 릴레이션으로 표현하고 릴레이션 각각에 대해 독립적 조작이 가능 |



##### 함수 종속성 (Fucntional Dependency)

- 하나의 릴레이션을 구성하는 속성들의 부분 집합을 X와 Y라고 할 때, 어느 시점에서든 릴레이션 내의 모든 튜플(행)을 대상으로 한 X 값에 대한 Y 값이 항상 하나면 X가 Y를 함수적으로 결정한다고 표현한다.
- X -> Y로 표기하고, Y는 X에 종속된다고 함. (X : 결정자, Y 종속자)
- 함수 종속성의 유형

| 유형             | 개념도                           | 설명                                                         |
| ---------------- | -------------------------------- | ------------------------------------------------------------ |
| 완전 함수 종속   | (A, B) -> C                      | 일반 속성이 식별자 전부에 종속                               |
| 부분 함수 종속   | (A, B) -> C, B -> C              | 일반 속성이 식별자 일부에 종속, 제 2 정규화 필요             |
| 이행 항수 종속   | (A, B) -> C, (A, B) -> D, C -> D | 일반 속성 간 함수적 종속, 제 3 정규화 필요                   |
| 결정자 함수 종속 | (A, B) -> C, C -> B              | 결정자가 후보키가 아닌 경우 존재, 후보키에 종속자 존재. BCNF 정규화 필요 |



##### 정규화의 유형

| 유형                      | 설명                                                         |
| ------------------------- | ------------------------------------------------------------ |
| 제1정규화(1NF)            | 릴레이션 R의 모든 속성 값이 원자값을 가지는 릴레이션         |
| 제2정규화(2NF)            | 릴레이션 R이 제1정규형이고, 기본키가 아닌 속성이 기본키에 완전 함수 종속일 때 |
| 제3정규화(3NF)            | 릴레이션 R이 제2정규형이고, 기본키가 아닌 속성이 기본키에 비이행적 non-transitive으로 종속할 때 (직접 종속) |
| 보이스/코드 정규화 (BCNF) | 릴레이션 R에서 함수 종속성 X -> Y가 성립할 때 모든 결정자 X가 후보키일 때 |
| 제4정규화(4NF)            | 릴레이션 R에서 MVD A ->> B가 존재할 때 R의 모든 속성들이 A에 함수 종속(FD)이면 R은 4NF(즉 R은 모든 속성 X에 대해 A -> X이고 A가 후보키) |
| 제5정규화(5NF)            | 릴레이션 R에 존재하는 모든 조인 종속이 R의 후보키를 통해 성립되면, R은 5NF |

- 정규화의 무손실 과정

비정규 릴레이션 -> 원자값이 아닌 도메인 분해 -> 1NF -> 부분함수 종속 제거 -> 2NF -> 이행 함수 종속 제거 -> 3NF -> 결정자가 후보키가 아닌 함수종속(FD) 제거 -> BCNF -> 함수종속이 아닌 다치종속(MVD) 제거 -> 4NF -> 후보키를 통하지 않은 조인종속(JD) 제거 -> 5NF



##### CRUD Matrix

- 모든 엔티티 목록을 나열하고 각각의 프로세스가 해당 엔티티에 대하여 생성(C), 조회(R), 변경(U), 삭제(D)하는 여부를 표기한 표이다.
- <u>프로세스와 엔터티의 상관관계를 이용해 구축된 엔터티 관계도를 검증 도구</u>
- CRUD Matrix 사례를 점검기준으로 설명하면 다음과 같다.

ex) <u>모든 엔터티에 CRUD가 한 번 이상은 표기되어야 한다</u>

- 엔터티 1의 삭제(D), 엔터티3(UD)가 빠져서 점검기준 불충분
- 엔터티2의, 엔터티4는 CRUD존재, 점검기준 충분

| 프로세스/엔터티 | 엔터티1 | 엔터티2 | 엔터티3 | 엔터티4 |
| --------------- | ------- | ------- | ------- | ------- |
| 프로세스1       | C       |         |         | RUD     |
| 프로세스2       |         | R       | C       |         |
| 프로세스3       | RU      | C       | R       |         |
| 프로세스4       | R       | RUD     |         | C       |



##### 논리적 설계 단계

주 식별자는 개체를 대표하는 유일한 식별자로서 유일성과 최소성을 만족해야 한다. 외래 식별자는 다른 개체를 참조하여 결과의 의미를 가지는 식별자이다.



##### 데이터베이스 키의 특징

| 특징   | 설명                                                         |
| ------ | ------------------------------------------------------------ |
| 유일성 | 하나의 키 값으로 하나의 튜플만을 유일하게 식별할 수 있어야 함. 기본키, 후보키, 슈퍼키 |
| 최소성 | 속성의 집합인 키가 릴레이션의 모든 튜플을 유일하게 식별하기 위해 꼭 필요한 속성들로 구성된 것을 의미. 기본키, 후보키 |



##### 데이터베이스 키 종류

| 종류   | 설명                                                         |
| ------ | ------------------------------------------------------------ |
| 후보키 | 릴레이션을 구성하는 속성들 중에서 튜플을 유일하게 식별할 수 있는 하나 또는 몇 개의 속성의 집합. 유일성과 최소성 모두 만족 (유일성, 최소성 O) |
| 기본키 | 릴레이션의 유일한 식별자(유일성, 최소성 O). 기본키로 지정된 속성은 같은 값을 갖지 못함. 후보키 중에서 선정된 키로 중복값 가질 수 없음. Not null, Unique, 외래키로 참조될 수 있음 |
| 대체키 | 후보키가 둘 이상 되는 경우에 기본키로 선택되지 못한 후보키들. 후보키 = 기본키 + 대체키 |
| 슈퍼키 | 유일성만 있고, 최소성이 없는 속성의 집합 (유일성 O, 최소성 X) |
| 외래키 | 한 테이블의 키 중 다른 테이블의 튜플을 식별할 수 있는 키     |

